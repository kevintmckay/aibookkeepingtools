{{- define "main" }}

{{- if .Site.Params.homeInfoParams }}
<article class="first-entry home-info">
    <header class="entry-header">
        <h1>{{ .Site.Params.homeInfoParams.Title | markdownify }}</h1>
    </header>
    <div class="entry-content">
        {{ .Site.Params.homeInfoParams.Content | markdownify }}
        
        <!-- Featured Tools Section -->
        <div class="featured-tools" style="margin: 2rem 0; padding: 1.5rem; background: var(--theme-bg); border-radius: 8px; border: 1px solid var(--border);">
            <h3 style="margin-top: 0; color: var(--primary);">ðŸš€ Popular AI Bookkeeping Tools</h3>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-top: 1rem;">
                <div style="text-align: center;">
                    <strong>QuickBooks AI</strong><br>
                    <small>Automated categorization</small>
                </div>
                <div style="text-align: center;">
                    <strong>Receipt OCR</strong><br>
                    <small>Smart expense scanning</small>
                </div>
                <div style="text-align: center;">
                    <strong>Expense Apps</strong><br>
                    <small>AI-powered tracking</small>
                </div>
                <div style="text-align: center;">
                    <strong>CPA Tools</strong><br>
                    <small>Workflow optimization</small>
                </div>
            </div>
        </div>
    </div>
    <footer class="entry-footer">
        <div class="social-icons">
            {{- range .Site.Params.socialIcons }}
            <a href="{{ .url }}" target="_blank" rel="noopener noreferrer me" title="{{ .name }}">
                {{- partial "svg.html" .name }}
            </a>
            {{- end }}
        </div>
    </footer>
</article>
{{- end }}

{{- $pages := union .RegularPages .Sections }}
{{- if .Site.Params.homeInfoParams }}
{{- $pages = (.Paginate (where .Site.RegularPages "Type" "in" .Site.Params.mainSections))}}
{{- else }}
{{- $pages = (.Paginate (where .Site.RegularPages "Type" "in" .Site.Params.mainSections)) }}
{{- end }}

<!-- Recent Posts Section -->
<header class="page-header">
    <h2>Latest AI Bookkeeping Guides</h2>
    <p>Stay updated with the newest AI accounting tools, tutorials, and industry insights.</p>
</header>

{{- if not .Site.Params.homeInfoParams }}
<article class="first-entry"> ... </article>
{{- end }}

{{- range $index, $page := $pages.Pages }}

{{- $class := "post-entry" }}

{{- $user_preferred := or .Site.Params.disableSpecial1stPost .Site.Params.homeInfoParams }}
{{- if (and $.IsHome (eq $index 0) (not $user_preferred)) }}
{{- $class = "first-entry" }}
{{- else if $user_preferred }}
{{- $class = "post-entry" }}
{{- end }}

<article class="{{ $class }}">
    {{- $isHidden := (.Params.cover.hidden | default .Site.Params.cover.hiddenInList) }}
    {{- if (and .Params.cover.image (not $isHidden)) }}
    <figure class="entry-cover">
        {{- $alt := (.Params.cover.alt | default .Params.cover.caption | default .Title) }}
        <img loading="lazy" src="{{ .Params.cover.image }}" alt="{{ $alt }}">
    </figure>
    {{- end }}
    <header class="entry-header">
        <h3>
            {{- .Title }}
            {{- if .Draft }}<sup><span class="entry-isdraft">&nbsp;&nbsp;[draft]</span></sup>{{- end }}
        </h3>
    </header>
    {{- if (ne (.Param "hideSummary") true) }}
    <div class="entry-content">
        <p>{{ .Summary | plainify | htmlUnescape }}{{ if .Truncated }} ...{{ end }}</p>
    </div>
    {{- end }}
    {{- if not (.Param "hideMeta") }}
    <footer class="entry-footer">
        <time>{{ .Date.Format "Jan 2, 2006" }}</time>
        {{- with .Params.tags }}
        &nbsp;Â·&nbsp;
        {{- range $index, $tag := . }}
        {{- if gt $index 0 }}, {{ end }}
        <span class="tag">{{ $tag }}</span>
        {{- end }}
        {{- end }}
        &nbsp;Â·&nbsp;{{ .ReadingTime }} min read
    </footer>
    {{- end }}
    <a class="entry-link" aria-label="post link to {{ .Title | plainify }}" href="{{ .Permalink }}"></a>
</article>
{{- end }}

{{- if gt $pages.TotalPages 1 }}
<footer class="page-footer">
    <nav class="pagination">
        {{- if $pages.HasPrev }}
        <a class="prev" href="{{ $pages.Prev.URL }}">
            Â«&nbsp;{{ i18n "prev_page" | default "Prev" }}
        </a>
        {{- end }}
        {{- if $pages.HasNext }}
        <a class="next" href="{{ $pages.Next.URL }}">
            {{ i18n "next_page" | default "Next" }}&nbsp;Â»
        </a>
        {{- end }}
    </nav>
</footer>
{{- end }}

{{- end }}{{/* end main */}}
